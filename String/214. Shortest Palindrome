class Solution {
    public String shortestPalindrome(String s) {
        String rev="";
        for (int i=s.length()-1; i>=0;i--) {
            rev+=s.charAt(i);
        }
        String combined = s + "#" + rev;
        int[] lps = new int[combined.length()];
        for (int i=1;i<combined.length();i++) {
            int len = lps[i-1];
            while (len > 0 && combined.charAt(i) != combined.charAt(len)) {
                len = lps[len-1];
            }
            if (combined.charAt(i) == combined.charAt(len)) {
                len++;
            }
            lps[i] = len;
        }
        int matchLength = lps[combined.length() - 1];
        String suffix="";
        for (int i=s.length()-1;i>=matchLength;i--) {
            suffix+=s.charAt(i);
        }
        return suffix+s;
    }
}
